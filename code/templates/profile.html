{% extends '../templates/base.html' %}


{% block main %}
<div style="background: #2E315B; height: 100%; padding-top: 20px; padding-left: 50px; color: white; font-size: 18px;">

<div style="font-size: 30px;"> Profile </div>

<div class="ui header" style="color: white;">
{{ msg }}
</div>

  <h4 style="color: white;" class="ui dividing header">Shipping Information</h4>

<div class="ui segment" style="max-width: 80%;">
<form class="ui form" id="shipping-info" method="post" action="/profile">
  <input type="text" value="shipping" name="type" style="visibility: hidden; display: none;" />
  <div class="field">
    <label>Name</label>
    <div class="two fields">
      <div class="field">
        <input type="text" id="first_name" name="first_name" placeholder="First Name" value="{{user_entry['first_name']}}">
      </div>
      <div class="field">
        <input type="text" id="last_name" name="last_name" placeholder="Last Name" value="{{user_entry['last_name']}}">
      </div>
    </div>
  </div>
  <div class="field">
    <label>Shipping Address</label>
    <div class="fields">
      <div class="twelve wide field">
        <input type="text" id="shipping_address" name="shipping_address" placeholder="Street Address" value="{{user_entry['shipping_address']}}">
      </div>
      <div class="four wide field">
        <input type="text" id="apt_num" name="apt_num" placeholder="Apt #" value="{{user_entry['apt_num']}}">
      </div>
    </div>
  </div>
  <div class="two fields">
    <div class="field">
      <label>State</label>
      <select name="state" id="state" class="ui fluid dropdown">
        <option value="">State</option>
    <option value="AL">Alabama</option>
    <option value="AK">Alaska</o  ption>
    <option value="AZ">Arizona</option>
    <option value="AR">Arkansas</option>
    <option value="CA">California</option>
    <option value="CO">Colorado</option>
    <option value="CT">Connecticut</option>
    <option value="DE">Delaware</option>
    <option value="DC">District Of Columbia</option>
    <option value="FL">Florida</option>
    <option value="GA">Georgia</option>
    <option value="HI">Hawaii</option>
    <option value="ID">Idaho</option>
    <option value="IL">Illinois</option>
    <option value="IN">Indiana</option>
    <option value="IA">Iowa</option>
    <option value="KS">Kansas</option>
    <option value="KY">Kentucky</option>
    <option value="LA">Louisiana</option>
    <option value="ME">Maine</option>
    <option value="MD">Maryland</option>
    <option value="MA">Massachusetts</option>
    <option value="MI">Michigan</option>
    <option value="MN">Minnesota</option>
    <option value="MS">Mississippi</option>
    <option value="MO">Missouri</option>
    <option value="MT">Montana</option>
    <option value="NE">Nebraska</option>
    <option value="NV">Nevada</option>
    <option value="NH">New Hampshire</option>
    <option value="NJ">New Jersey</option>
    <option value="NM">New Mexico</option>
    <option value="NY">New York</option>
    <option value="NC">North Carolina</option>
    <option value="ND">North Dakota</option>
    <option value="OH">Ohio</option>
    <option value="OK">Oklahoma</option>
    <option value="OR">Oregon</option>
    <option value="PA">Pennsylvania</option>
    <option value="RI">Rhode Island</option>
    <option value="SC">South Carolina</option>
    <option value="SD">South Dakota</option>
    <option value="TN">Tennessee</option>
    <option value="TX">Texas</option>
    <option value="UT">Utah</option>
    <option value="VT">Vermont</option>
    <option value="VA">Virginia</option>
    <option value="WA">Washington</option>
    <option value="WV">West Virginia</option>
    <option value="WI">Wisconsin</option>
    <option value="WY">Wyoming</option>
      </select>
    </div>
  </div>
</form>
</div>
<button onClick="saveShippingInfo();" class="ui large green inverted button" tabindex="0">Save Shipping Information</button>

<div class="ui divider" style="width: 90%; border-bottom: 1px solid white;"></div>

<h4 style="color: white;" class="ui dividing header">Payment Information</h4>
<div class="ui segment" style="width: 80%;">





<form class="ui form" id="payment-info" method="post" action="/profile">

  <input type="text" value="payment" name="type" style="visibility: hidden; display: none;" />
  <div class="fields">
    <div class="eight wide field">
      <label>Card Number</label>
      <input type="text" name="card_number" id="card_number" maxlength="16" placeholder="Card #" value="{{user_entry['card_number']}}">
    </div>
    <div class="three wide field">
      <label>CVC</label>
      <input type="text" name="cvc" id="cvc" maxlength="3" placeholder="CVC" value="{{user_entry['cvc']}}">
    </div>
  </div>

  <div class="fields">
    <div class="six wide field">
    <label>Expiration</label>
      <select class="ui fluid dropdown" name="expiration_month" id="expiration_month">
        <option value="">Month</option>
        <option value="1">January</option>
        <option value="2">February</option>
        <option value="3">March</option>
        <option value="4">April</option>
        <option value="5">May</option>
        <option value="6">June</option>
        <option value="7">July</option>
        <option value="8">August</option>
        <option value="9">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
      </select>
    </div>
    <div class="three wide field">
    <label style="visibility: hidden;">aksdmlaksdm</label>
      <input type="text" name="expire_year" maxlength="4" placeholder="Year" id="expire_year" value="{{user_entry['expire_year']}}">
    </div>
  </div>














</form>








</div>




<button onClick="savePaymentInfo();" class="ui large green inverted button" tabindex="0">Save Payment Information</button>







</div>
<script>
var user_entry = {% raw json_user %}

$("#state")
.dropdown('set selected', user_entry['state'])


console.log(user_entry)
$('#expiration_month')
  .dropdown('set selected', user_entry['expiration_month'])
;



$('#shipping-info')
  .form({
    fields: {
      first_name     : 'empty',
      last_name: 'empty',
      shipping_address   : 'empty',
      state : 'empty'
    }
  })
;


$('#payment-info')
  .form({
    fields: {
      card_number: 'empty',
      cvc: 'empty',
      expiration_month: 'empty',
      expire_year: 'empty'
    }
  })
;

$("#state").val(user_entry['state'])


function post(path, params, method) {
    method = method || "post"; // Set method to post by default if not specified.

    // The rest of this code assumes you are not using a library.
    // It can be made less wordy if you use one.
    var form = document.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", path);

    for(var key in params) {
        if(params.hasOwnProperty(key)) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", params[key]);

            form.appendChild(hiddenField);
         }
    }

    document.body.appendChild(form);
    form.submit();
}


function saveShippingInfo(){
  let first_name = $("#first_name").val()
  let last_name = $("#last_name").val()

  let shipping_address = $("#shipping_address").val()
  let apt_num = $("#apt_num").val()

  let state = $("#state").val()

  if( first_name && last_name && shipping_address && state ){
    post('/profile',{
      type: 'shipping',
      first_name: first_name,
      last_name: last_name,
      shipping_address: shipping_address,
      apt_num: apt_num,
      state: state
    })
  }

}



function savePaymentInfo(){



  let card_number = $("#card_number").val()
  let cvc = $("#cvc").val()

  let expiration_month = $("#expiration_month").val()
  let expire_year = $("#expire_year").val()

  if( card_number && cvc && expiration_month && expire_year ){
    
    post('/profile',{
      type: 'payment',
      card_number: card_number,
      cvc: cvc,
      expiration_month: expiration_month,
      expire_year: expire_year
    })

  }
}





















</script>


{% end %}